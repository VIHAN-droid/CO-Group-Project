import sys

func3 = {
    "000": ["add", "sub", "addi", "jalr", "beq"],
    "010": ["slt", "lw", "sw"],
    "101": ["srl"],
    "110": ["or"],
    "111": ["and"],
    "001": ["bne"]
}

func7 = {
    "0000000": ["add", "slt", "srl", "or", "and"],
    "0100000": ["sub"]
}

opcode = {
    "0110011": ["add", "sub", "slt", "srl", "or", "and"],
    "0000011": ["lw"],
    "0010011": ["addi"],
    "1100111": ["jalr"],
    "0100011": ["sw"],
    "1100011": ["beq", "bne"],
    "1101111": ["jal"]
}

register = {
    'PC': 0, 'x0': 0, 'x1': 0, 'x2': 380, 'x3': 0, 'x4': 0, 'x5': 0, 'x6': 0, 'x7': 0,
    'x8': 0, 'x9': 0, 'x10': 0, 'x11': 0, 'x12': 0, 'x13': 0, 'x14': 0, 'x15': 0,
    'x16': 0, 'x17': 0, 'x18': 0, 'x19': 0, 'x20': 0, 'x21': 0, 'x22': 0, 'x23': 0,
    'x24': 0, 'x25': 0, 'x26': 0, 'x27': 0, 'x28': 0, 'x29': 0, 'x30': 0, 'x31': 0
}

memory_32_bit = {
    "0x00010000": "0b00000000000000000000000000000000",
    "0x00010004": "0b00000000000000000000000000000000",
    "0x00010008": "0b00000000000000000000000000000000",
    "0x0001000C": "0b00000000000000000000000000000000",
    "0x00010010": "0b00000000000000000000000000000000",
    "0x00010014": "0b00000000000000000000000000000000",
    "0x00010018": "0b00000000000000000000000000000000",
    "0x0001001C": "0b00000000000000000000000000000000",
    "0x00010020": "0b00000000000000000000000000000000",
    "0x00010024": "0b00000000000000000000000000000000",
    "0x00010028": "0b00000000000000000000000000000000",
    "0x0001002C": "0b00000000000000000000000000000000",
    "0x00010030": "0b00000000000000000000000000000000",
    "0x00010034": "0b00000000000000000000000000000000",
    "0x00010038": "0b00000000000000000000000000000000",
    "0x0001003C": "0b00000000000000000000000000000000",
    "0x00010040": "0b00000000000000000000000000000000",
    "0x00010044": "0b00000000000000000000000000000000",
    "0x00010048": "0b00000000000000000000000000000000",
    "0x0001004C": "0b00000000000000000000000000000000",
    "0x00010050": "0b00000000000000000000000000000000",
    "0x00010054": "0b00000000000000000000000000000000",
    "0x00010058": "0b00000000000000000000000000000000",
    "0x0001005C": "0b00000000000000000000000000000000",
    "0x00010060": "0b00000000000000000000000000000000",
    "0x00010064": "0b00000000000000000000000000000000",
    "0x00010068": "0b00000000000000000000000000000000",
    "0x0001006C": "0b00000000000000000000000000000000",
    "0x00010070": "0b00000000000000000000000000000000",
    "0x00010074": "0b00000000000000000000000000000000",
    "0x00010078": "0b00000000000000000000000000000000",
    "0x0001007C": "0b00000000000000000000000000000000"
}

memory_dec = {
    "0x00010000": "0", "0x00010004": "0", "0x00010008": "0", "0x0001000C": "0",
    "0x00010010": "0", "0x00010014": "0", "0x00010018": "0", "0x0001001C": "0",
    "0x00010020": "0", "0x00010024": "0", "0x00010028": "0", "0x0001002C": "0",
    "0x00010030": "0", "0x00010034": "0", "0x00010038": "0", "0x0001003C": "0",
    "0x00010040": "0", "0x00010044": "0", "0x00010048": "0", "0x0001004C": "0",
    "0x00010050": "0", "0x00010054": "0", "0x00010058": "0", "0x0001005C": "0",
    "0x00010060": "0", "0x00010064": "0", "0x00010068": "0", "0x0001006C": "0",
    "0x00010070": "0", "0x00010074": "0", "0x00010078": "0", "0x0001007C": "0"
}

key_list = [
    "0x00010000", "0x00010004", "0x00010008", "0x0001000C",
    "0x00010010", "0x00010014", "0x00010018", "0x0001001C",
    "0x00010020", "0x00010024", "0x00010028", "0x0001002C",
    "0x00010030", "0x00010034", "0x00010038", "0x0001003C",
    "0x00010040", "0x00010044", "0x00010048", "0x0001004C",
    "0x00010050", "0x00010054", "0x00010058", "0x0001005C",
    "0x00010060", "0x00010064", "0x00010068", "0x0001006C",
    "0x00010070", "0x00010074", "0x00010078", "0x0001007C"
]
def R_type(inst):
    ins = inst[1]
    rd = int(inst[2], 2)
    rs2 = int(inst[3], 2)
    rs1 = int(inst[4], 2)
    result = 0
    if ins == 'add':
        result = register[f'x{rs1}'] + register[f'x{rs2}']
    elif ins == 'sub':
        result = register[f'x{rs1}'] - register[f'x{rs2}']
    elif ins == 'or':
        result = register[f'x{rs1}'] | register[f'x{rs2}']
    elif ins == 'and':
        result = register[f'x{rs1}'] & register[f'x{rs2}']
    elif ins == 'slt':
        result = 1 if register[f'x{rs1}'] < register[f'x{rs2}'] else 0
    elif ins == 'srl':
        result = (register[f'x{rs1}'] % (1 << 32)) >> (register[f'x{rs2}'] & 0x1F)
    if rd != 0:
        register[f'x{rd}'] = result
    register['PC'] += 4
